# Inherit Styles

## 3.4.2 Inheriting Styles

Iframes are a great way to defend your content from infringing parent styles and
JavaScript code. But their greatest benefit is also their major downside. As-is, your
iframe will inherit nothing from the parent page, including font family, font size, font
color, and a suite of other styles. In your effort to make your widget look consistent
everywhere by embedding it in an iframe, it might end up looking strangely out of
place because it doesn’t inherit some of the page’s native styles (see figure 3.6).
The solution? Use JavaScript to detect the parent page’s basic style rules, and inject
them into your iframe. In the case of a src-less iframe, you can inject the styles directly
from your third-party script. For an external iframe, you’ll need to pass the styles as
part of the URL or hash fragment, and use code running on the external URL to inject
the styles.
DETECTING A PAGE’S BASIC STYLES
First up, how do you detect a page’s basic styles? Take a look at the helper function in
the following listing, which takes an element and a style property (such as font-size),
and returns the value of that property.

**Listing 3.7 Finding the value of an element’s style property**

Some of this code should look familiar from the isCssReady function in listing 3.4.

What’s different is that if a style rule isn’t explicitly set on the given element, get-
Style traverses up the DOM until it finds the closest parent with a proper value.

Transparent values are also skipped for color-based properties, because the real color

is being inherited from a parent. Additionally, this function requires both standard-

form property names (such as background-color) and camel-case versions of those
names (backgroundColor) where they differ, because the now-deprecated Microsoft
accessor (node.currentStyle) uses the latter.
Next up is to use this function to determine which styles should be applied to your

iframe. To do this, you should use getStyle to query some basic styles on the con-
tainer element that’s the direct parent of your widget (after it has been inserted into

the publisher’s DOM). These are the styles that would’ve been inherited by your wid-
get, if it wasn’t being stowed away in an iframe.

The function in the following listing uses getStyle to find out the font color,
background color, font direction, font family, and anchor color of a given container
element.

These are just some suggested styles that you should query for; feel free to test for
other styles you think are important. Text direction is a neat one: it’s used to style a

website with right-to-left text (like Hebrew or Arabic). Just like font color or font fam-
ily, it won’t be applied to your iframe unless you pass it along manually.

APPLYING STYLES TO AN IFRAME
Now it’s time to apply the basic styles you’ve collected from the publisher’s page to
your iframe. As we mentioned earlier, for a src-less iframe, this is pretty easy, because
you can access the iframe’s properties from your main application code. The code in
listing 3.9 introduces a function, applyStyles, that takes the style hash you returned
from getBasicStyles and applies it to a document object (like the one belonging to
your iframe).

**Listing 3.9 Applying style rules to a document’s body element**

This function is straightforward. It iterates through the hash of style objects, and
applies them one by one to the given document’s body element. By putting these styles
on your iframe’s body element, they’ll effectively act as base styles inherited by your
HTML and CSS. Dope!
Now, if you’re using an iframe that’s hosting external content, things get trickier,
but it’s not too bad. One method is to pass the detected styles as part of the URL that
loads your external document. This can be done by converting the styles hash to
query string or hash fragment parameters. Then, from JavaScript code running on the

external document, extract the parameters from the URL (using some of the parame-
ter-passing techniques from section 2.5), and use the applyStyles function to inject

them into the page. Figure 3.7 illustrates this process.

---

#### From [[_4_embed-iframes]]

[//begin]: # "Autogenerated link references for markdown compatibility"
[_4_embed-iframes]: _4_embed-iframes "Embed iFrames"
[//end]: # "Autogenerated link references"
