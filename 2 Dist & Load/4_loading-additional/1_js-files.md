# JS Files

## 2.4.1 JavaScript Files

To load additional JavaScript files from your application, you’ll use the same tech-
nique from the asynchronous script include snippet. If you recall, that snippet created

a new <script> tag element using document.createElement, and then appended it to
the DOM.
This time around, there are a few catches. For starters, you’ll need to know when
the file has been loaded by the browser before you can execute any functions it

declares. Second, seeing as you might have to load several JavaScript files in this fash-
ion, you’ll want to encapsulate this code in a reusable function.

Figuring out when a file has been loaded isn’t too tricky. The browser has events
that can be listened to that report when a file has been loaded (see figure 2.5). The
only catch is that different browsers support different onload events, and you’ll need

to support all of them. Also, since you don’t have any helpful JavaScript libraries avail-
able (yet), you’ll need to write the raw event-handling code yourself.

The following listing shows an implementation of such a script-loading function,
which we’ve dubbed loadScript. The behavior of this function is visualized in figure 2.5.

**Figure 2.5 The loadScript function loads a JavaScript file from the provided URL and invokes a callback function when that files is ready.**

**Listing 2.3 Asynchronous JavaScriopt loader function**

Listing 2.4 shows loadScript in action. Imagine that you depend on a file named
dom.js that contains a number of cross-browser DOM helper functions critical to your
application. The contents of dom.js might look something like this listing.

Organizing your code into modules like this isn’t required; it’s a convention we’ve
used in developing our own JavaScript apps. We find grouping functions into logically

separated modules makes good sense. You could alternatively place new utility meth-
ods directly on the top-level namespace object. As long as you’re not declaring new

global functions, we won’t object.
To load dom.js and gain access to its helper methods, loadScript is used as follows:

Don’t forget that loadScript loads files asynchronously. In this example, the DOM
helper functions aren’t ready until loadScript’s callback parameter has executed.
Invoking the helper functions immediately after calling loadScript will throw an
exception; the code hasn’t been loaded yet.

---

#### [[_4_loading-additional]]

[//begin]: # "Autogenerated link references for markdown compatibility"
[_4_loading-additional]: _4_loading-additional "Loading Additional Files"
[//end]: # "Autogenerated link references"
