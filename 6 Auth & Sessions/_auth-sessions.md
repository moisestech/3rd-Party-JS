# 6️⃣ Auth & Sessions

## **This Chapter Covers**

1. Intro to **3rd Party Cookies**
2. Auth and **Persisting Sessions** from your 3rd Party App
3. **Workarounds when 3rd Party Cookies are Disabled**
4. Techniques for **defending against session hijacking**

## **Intro**

Up until this point, we’ve been implementing user-agnostic applications. No matter
who’s loaded your third-party script, they all experience the same version of the

application. But what if, instead, your application could identify users who are cur-
rently (or previously) signed in to your service? Leveraging any data you might

have about that user, you might be able to deliver them a customized and improved
experience.

You’ve probably seen this behavior in third-party applications before. For exam-
ple, Facebook’s omnipresent Like button knows whether you’re currently signed in
to Facebook. Sometimes it’ll show you if your friends have already “Liked” the content
you’re viewing. Or if you click the Like button yourself, it’ll automatically share that
content to your Facebook news feed, without prompting you to log in.
You can bring some of these features to the Camera Stork product widget. Nay—
you must. If you can identify that viewers of the widget are already signed in to your
store at camerastork.com, you can enhance their experience of viewing your widget.
For example, you can tell them whether they already own the product in question.
You can remember and display their rating for this product, if they have previously
reviewed it. Or maybe you can show them that this product is currently on their wish
list, which might rekindle their interest in purchasing.
All of these are nice features. But in order to implement them, your application
needs to know whether the user is currently authenticated with your service. This is

normally a straightforward operation for standard web applications, but for third-
party scripts it’s another story. This is because browsers can prevent third-party appli-
cations from reading or setting cookies, which are the primary ingredient in persisting

sessions between browser requests. That’s a devastating blow, but it doesn’t mean
you’re out of luck—there are a handful of browser-specific workarounds and fallbacks
that will help you persist sessions in the face of discriminatory browser settings.
In this chapter, you’ll learn what third-party cookies are, how they can be disabled
by different browsers, and what effect this has on your applications. Afterward, we’ll

look at workarounds on specific browsers for setting third-party cookies, and at fall-
back techniques when no such workarounds are available. Last, we’ll look at some

security issues concerning cookies, and steps you can take to protect against them.
First up: what are third-party cookies, anyways?

## **Intro**

## **6.1 3rd-Party Cookies**

## **6.2 Setting 3rd-Party Cookies**

## **6.3 Securing Sessions**

## **6.4 Summary**

- **Authenticating and persisting sessions with third-party applications is tough to implement**, but not impossible.
- The **difficulty is that each browser treats disabling third-party cookies differently**, and you’ll need to supply different workaround solutions to support them all.
  - For **IE, Opera, and Safari, which transmit cookies to third-party domains if they’re already set, you can always open a new window to a login page on your domain and set the cookie there**.
  - **Safari can even use iframes, provided the session cookie is set in the response to a standard form POST HTTP request**.
  - **Chrome and Firefox, the most restrictive browsers with respect to third-party cookies, must make do with sessions that only last the duration of the user’s stay on the page**.
- Of course, just setting and sending a session cookie isn’t enough.
  - You also need to **transmit that cookie in such a way that it isn’t easily snoopable by malicious parties**.
- **The solution is to use HTTPS everywhere you send session information**.
- But if that’s not realistic for your organization, **you can use a mixed approach where high-touch actions are served behind HTTPS**,
  - **and actions performed from your third-party application use unencrypted HTTP**.
- **Session hijacking is, unfortunately, one of many possible security vulnerabilities** affecting third-party JavaScript applications.
- We’ve mentioned a handful of others over the course of this book.

#### Next Chapter

[[_security]]

- But in the next chapter, we’ll take an in-depth look at the largest security issues facing your application and introduce practices for either eliminating them or mitigating their impact.
- Shall we?

## **Sub-chapters**

---

#### From [[_auth-sessions]]

[//begin]: # "Autogenerated link references for markdown compatibility"
[_security]: ../7 Security/_security "7️⃣ Security"
[_auth-sessions]: _auth-sessions "6️⃣ Auth & Sessions"
[//end]: # "Autogenerated link references"
