# Https Secure Cookies

## **6.3.1 HTTPS and secure cookies**

By design, HTTP transmits all data in plain text using the plain Transmission Control Pro-
tocol—better known as TCP. This leads to the vulnerabilities we just described, where

an attacker can sniff cookies on an unencrypted Wi-Fi network. It can also lead to a

man-in-the-middle (MITM) attack, where an attacker positions themselves on the net-
work between their victims—the client and server—and then intercepts and relays

messages between the victims such that they never realize that their line of communi-
cation has been breached. Just like packet sniffing, in an MITM attack, the attacker

merely needs to watch the unencrypted HTTP traffic in order to identify and hijack
cookies containing session information.

The solution to these types of attacks is HTTPS (HTTP Secure), which is a combina-
tion of HTTP and the Transport Security Layer (TLS) cryptographic protocol. It works

just like HTTP, but routes all data through a secure encrypted tunnel,5

thereby pre-
venting your data from being intercepted and read by unauthorized parties. Com-
bined with secure cookies, which are only transmittable through HTTPS, you can

effectively put a halt to session hijacking.
Setting a secure cookie, like regular cookies, is done using the Cookie-set HTTP
header. The last parameter, secure, is what sets them apart:
Set-cookie: sessionid=66d2520a77a3c6dac4db658c6dd13061; secure
Afterward, this cookie will be sent by the browser with all requests to https://
camerastork.com. By stating that it’s a secure cookie, the browser will not transmit
this cookie to any non-HTTPS requests to the same domain (http://camerastork
.com). If it did, using HTTPS would offer little protection, because the same cookie
would be sent in plain text for any non-HTTPS requests, undermining our efforts.
Basically, be aware of the secure flag when setting cookies, and use it for cookies
that should only be transmitted over HTTPS.
If you ever need to set a secure cookie via JavaScript, document.cookie uses the
same syntax as the Set-cookie header:
document.cookie = 'sessionid=66d2520a77a3c6dac4db658c6dd13061; secure';
Ideally, you should use HTTPS everywhere you transmit sessions. But HTTPS can be a
complicated undertaking, particularly for high-traffic, distributed applications like
third-party scripts. If you’re a small operation, and learning to scale HTTPS isn’t in
your immediate future, there’s an alternative approach that can minimize the impact
of session hijacking without the overhead of using HTTPS for every request: multilevel
authentication.

---

#### From [[1_https-secure-cookies]]

[//begin]: # "Autogenerated link references for markdown compatibility"
[1_https-secure-cookies]: 1_https-secure-cookies "Https Secure Cookies"
[//end]: # "Autogenerated link references"